{% block content %}
  <form id="report_form">
    <div class="container p-4 shadow" style="background-color: #F8DCDC;">
      <h1 class="text-center fw-bold fs-2">Report Form</h1>
      <div class="d-flex flex-column gap-1 my-3">
        <label for="report_types" class="fw-bold">Report type</label>
        <select id="report_types" name="report_types" class="fw-bold p-1 border-0" style="color: #D43F3A;">
          {% for report_type in report_types %}
            <option value="{{ report_type.id }}">{{ report_type.report_type }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="d-flex flex-column gap-1 my-3">
        <label for="coordinator" class="fw-bold">Coordinator</label>
        <input type="text" id="coordinator" placeholder="enter your name" class="fw-bold p-1 border-0" style="color: #D43F3A;" required />
      </div>
      <div class="d-flex flex-column gap-1 mb-4 my-3">
        <label for="no_of_pax" class="fw-bold">No of pax</label>
        <select id="no_of_pax" name="no_of_pax" class="fw-bold p-1 border-0" style="color: #D43F3A;">
          {% for no in no_of_pax %}
            <option value="{{ no }}">{{ no }}</option>
          {% endfor %}
        </select>
      </div>

      <button type="submit" class="w-100 text-white fw-bold p-2" style="background-color: #D43F3A; letter-spacing: 10px;">Report</button>
    </div>
  </form>

  <script>
    $('#report_form').on('submit', (event) => {
      event.preventDefault()
      alert('Thank you for reporting.')
      // flow after submitting report form
      // 1. collect data
      // 2. send data AJAX
      // 3. IF SUCCESS? reset the form FAIL? inform the user alert!
    
      // 1. collect data
      // data - branch_id, report_type_id, coordinator, no_of_pax
      const branch_id = '{{ branch_id }}'
      const report_type_id = $('#report_types').val()
      const coordinator = $('#coordinator').val()
      const no_of_pax = $('#no_of_pax').val()
      const collected_data = {
        branch_id: branch_id,
        report_type_id: report_type_id,
        coordinator: coordinator,
        no_of_pax: no_of_pax
      }
    
      // 2. send data
      $.ajax({
        type: 'POST',
        url: window.location.origin + '/branch/api/send_report/',
        data: collected_data,
        dataType: 'json'
      }) // SUCCESS
        .done((json) => {
          window.location.reload()
          // reset the form values
          // $('#report_types').val('1')
          // $('#coordinator').val('')
          // $('#no_of_pax').val('1')
        }) // FAIL
        .fail((xhr, status, errorThrown) => {
          alert('Sorry, there was a problem!')
          console.log('Error: ' + errorThrown)
          console.log('Status: ' + status)
          console.dir(xhr)
        })
    })
  </script>
{% endblock %}
